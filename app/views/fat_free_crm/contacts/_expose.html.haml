.remote
  = form_for(@contact, url: exposed_contact_path(@contact), html: one_submit_only, remote: true) do |f|
    = link_to_close expose_contact_path(@contact)
    .idc-panel
      .full-width
        %h3
          = @contact.full_name
      .form-group.one-quarter
        %label #{t :phone}:
        .form-control
          = @contact.phone
      .form-group.one-third
        %label #{t :email}:
        .form-control
          = @contact.email
      = fields_for(:opportunity, opportunity = FatFreeCrm::Opportunity.new) do |o|
        .form-group.one-half
          .label #{t :case_type}
          = select_tag("opportunity_id", options_for_select(FatFreeCrm::Opportunity.all.pluck(:name, :id), selected: "Tested Positive"), { class: 'form-control' })
        #tested-positive.idc-panel.full-width.nested
          .form-group.one-third
            .label #{t :notified_at}:
            = datetime_field_tag("opportunity[notified_at]", nil, autocomplete: :off, required: true, class: 'date form-control')
          .form-group.one-sixth
            .label #{t :self_notified}:
            = check_box_tag("self_notified", true, true, class: 'form-control form-control-sm')
          #notifying-contact-details.one-half.hidden
            .form-group.one-quarter{id: "contact_#{time}"}
              .label #{t :notifying_contact}:
              = text_field_tag("opportunity[notifying_contact]", nil, required: false, class: 'form-control')
              = hidden_field_tag("opportunity[notifying_contact_id]")
            .form-group.one-quarter
              .label #{t :notifying_contact_relationship_kind}:
              = select_tag("opportunity[notifying_contact_relationship]", options_for_select(CovidMostRegistry[:contact_relationship].item), { prompt: 'Select Relationship', class: 'form-control'})
        #exposed.idc-panel.full-width.nested
          .form-group.one-quarter
            .label #{t :source_name}:
            = text_field_tag("opportunity[source_name]", nil, class: 'form-control')
          .form-group.one-quarter
            .label #{t :source_relationship}:
            = select_tag("opportunity[source_relationship]", options_for_select(Setting.unroll(:source_relationship)), class: 'form-control')
          .form-group.one-quarter
            .label #{t :source_start_at}:
            = datetime_field_tag("opportunity[source_start_at]", nil, class: 'form-control')
          .form-group.one-quarter
            .label #{t :source_end_at}:
            = datetime_field_tag("opportunity[source_end_at]", nil, class: 'form-control')
          .form-group.one-quarter
            .label #{t :exposure_level}:
            = select_tag("opportunity[exposure_level]", options_for_select(Setting.unroll(:exposure_level)), class: 'form-control')
      .buttonbar.full-width
        = f.submit t(:save_case), :class => 'btn btn-primary'
        = link_to_cancel expose_contact_path(@contact), :class => 'btn btn-link'

= javascript_include_tag("awesomplete")
= stylesheet_link_tag("awesomplete")
