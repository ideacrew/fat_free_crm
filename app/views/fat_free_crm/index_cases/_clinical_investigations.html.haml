- model = entity.class.name.underscore
%details.idc-panel.clinical-investigations
  %summary #{t :clinical_simple_investigations}
  .full-width
    = f.fields_for :clinical_investigations do |investigation_form|
      = render "fat_free_crm/index_cases/clinical_investigation_fields", f: investigation_form #, entity: entity
  #new_investigation
    = link_to_add_fields "#{t :new_investigation}", f, :clinical_investigations

:javascript
  function deleteInvestigation(el) {
    text = "Are you sure you wish to delete this investigation?";
    response = confirm(text);
    if (response == true) {
      hidden_input_id = el.closest('#index-case-investigation').querySelector('input[type="datetime-local"]').id.replace('interview_at', '_destroy');
      el.closest('#index-case-investigation').parentNode.querySelector('input[id="' + hidden_input_id + '"]').value = true;
      el.closest('#index-case-investigation').remove();
    }
  }

  $(document).on("click",'.clinical-investigations .add_fields',function(event) {
    prependFormWithContactFields($(this), 'div#index-case-investigation');
    var create_or_select_contact_elements = $(this).siblings().last()[0].querySelectorAll('.contact-select-create');
    create_or_select_contact_elements.forEach( function(selector) {
      crm.create_or_select_contact(selector);
    });
  });
